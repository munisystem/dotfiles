# {{{ general
export LANG=ja_JP.UTF-8
autoload -Uz cdr history-search-end

# ヒストリ補完
zle -N history-beginning-search-backward-end history-search-end
zle -N history-beginning-search-forward-end history-search-end
bindkey '^P' history-beginning-search-backward-end
bindkey '^N' history-beginning-search-forward-end

setopt always_to_end

# }}}
# {{{ alias
alias shutdown='sudo shutdown -h now'
alias sudo='sudo '
alias mkdir='mkdir -p'

alias -s php=gvim
alias -s html=gvim
alias -s txt=gvim
alias -s xml=gvim
alias -s css=gvim
alias -s js=gvim
alias -s cpp=gvim
# }}}
# {{{ peco
function peco-history() {
  local tac
    if which tac > /dev/null; then
      tac="tac"
    else
      tac="tail -r"
    fi
  BUFFER=$(\history -n 1 | \
    eval $tac | \
    awk '!a[$0]++' | \
    peco --query "$LBUFFER")
 CURSOR=$#BUFFER
 zle clear-screen
}
zle -N peco-history

bindkey '^S' peco-history

#        function peco-cdr() {
#            local selected_dir=$(cdr -l | awk '{ print $2 }' | peco)
#                if [ -n "$selected_dir" ]; then
#                    BUFFER="cd ${selected_dir}"
#                        zle accept-line
#                        fi
#                        zle clear-screen
#        }
#    zle -N peco-cdr
#
#        bindkey '^f' peco-cdr
# }}}
# {{{ enhancd
function enhancd() {
  ecd
  zle clear-screen
}
zle -N enhancd
bindkey '^R' enhancd
# }}}
